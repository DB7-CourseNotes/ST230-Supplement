---
title: Tests for Proportion(s)
---

## One-Sample Proportions

Note that proportion tests are only valid when $np > 15$ and $n(1-p)>15$. [Here's why.](https://shinylive.io/r/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAGwEsAjAJykYE8AKAZwAtaJWAlAB0IIgK60ABAB4AtJIBm1CQBMAClADmcdiMn7JnWirj0WGiHGq6IBu4bonGASQioxpXZCF5JPgHJiMPRwjJJECpKkjLRQ1Jw+uJIAjEnJAAzpSQCsuHr2BVAQtDBQ5JIAvJJ0nJ585IwAbnGVktmZAgJ5tgUOxqGu7p4+qIl+YGqMRPQY4ZGcYgQEcJwJvlkpSekYufm9BkUlZXCtNXVkoc3Ure3pnd37BNxwBADW9EQAHoMeXhBEjBgYx8ABFmAB3ST+AGla4AQXQU0+R1ItBIAH4xgAxOEAGQAygBRYQ9fRdPaSUp8CxWdioahEUgAeQ8Qy89MZPi6khJJJEnEuoRk8gUYggBFRJHYfCGSSIrI8AkkIAp8tIQwAJBzSMLJIwKE41AzPCrSfYYGJdTKPBrbAAqSTW0hail2IyaUq6zgAR0Yngtkgd7GSknkTq1nVdBhUAu9Xrg3vYG3DEDSJMesfjiYD8gAzHb3aUkgGANSSfOFqBbDCZZLp3r-QGZuSSFSNmDsAix4tiJKV+sFeh8IgwZvyFRD-4dmMJvu0ABeJyqKaSqCm9Fa4dQA-s2vYM7j8m2uUkk5H3airFQS-G3C5Uf0dEsnH3maPOySZ9Hs8v19aPjWHc7FoSJpTcG12yA3onxWTsL3bC9iGuKoACYdwAXxJdCRH5Xh+ARVB2AkVoJD7QUwiqAUmlCEkwHQgBdIA) Notice how the normal approximation goes off the edges of the plot when $np$ is small or $n(1-p)$ is large.

### R as a calculator

Confidence interval from class:

```{webr-r}
successes <- 515
n <- 1921

phat <- successes / n
cat("phat: ", phat)

se_phat <- sqrt(phat * (1 - phat) / n)
cat("se_phat: ", se_phat)

# For a 95% CI, we need 2.5% to the left
z_star <- abs(qnorm((1 - 0.95) / 2))
cat("z_star: ", z_star)

phat + c(-1, 1) * z_star * se_phat
```

### R as a sophisticated statistics program

R does a few slightly different things to account for the fact that the normal distribution is continuous but the binomial distribution is discrete, so the answer differs slightly (this is important for WeBWorK - check your work with R, but do it by hand)!

```{webr-r}
prop.test(x = 515, n = 1921)
```

Notice that R also produces a hypothesis test. By default, it checks for $H_0:p = 0.5$ versus a two-sided alternative. 

For proportions, a confidence interval is **_not_** equivalent to a two-sided hypothesis test - the CI and the HT each use a different standard error!

## Two-Sample Proportions

(This will be filled out more by next class.)

The `prop.test()` function also works with two samples!

```{webr-r}
n1 <- 2841
x1 <- 77

n2 <- 2297
x2 <- 107

prop.test(x = c(x1, x2), n = c(n1, n2))
```
